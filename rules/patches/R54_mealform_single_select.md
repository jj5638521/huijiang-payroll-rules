# R54 施工说明单选驱动（MealForm Single Select）

## 版本与作用域
- 规则版本：R54（v2026-02-11R54-MealFormSingleSelect）。
- 生效模块：仅 AttendancePipe。
- 输入限制：禁止读取 PaymentPipe 字段或状态参与本规则判断。

## 字段识别
在 AttendancePipe 内新增“施工说明”映射，按“表头清洗后取首个非空列”原则匹配：
- 施工说明 ← 列名包含：`施工说明` | `问题描述` | `其他说明`

说明：该字段可能来自表单单选题，单元格值为选项文本。

## 单选值到规则映射（自动识别）
按 `日期 + 项目 + 车组` 分组应用。车组优先使用“车牌/车辆”列；若车组列缺失，则退化为 `日期 + 项目` 全组。

### 1) 命中“施工-无工作餐”（或包含该字样）
- 语义：当日“施工=是”的同车组人员，餐补口径从 25 提至 40。
- 作用范围：仅施工日人员。
- 约束：不得作用于待命/未施工日。
- 混合场景：同日同车组施工人与非施工人混杂时，仍仅对“施工=是”人员提至 40。

### 2) 命中“未施工-全组无餐补”（或包含该字样）
- 语义：当日“施工≠是 且 岗位命中=是”的待命人员，餐补从默认 40 调整为 0。
- 作用范围：仅待命集合；施工日不受影响。
- 无车组时：作用范围退化为“当日该项目全组待命人员”。

## 优先级与冲突处理
优先级从高到低：
1. 个人级归零（点名归0 / 清零 / 无需算饭补）
2. R54 车组级规则（MealForm Single Select）
3. 默认餐补规则

冲突处理：
- 同一 `日期+项目+车组` 同时命中“施工-无工作餐”和“未施工-全组无餐补”时允许并存。
- 并存时不互相覆盖：
  - 前者仅作用施工=是人员；
  - 后者仅作用待命（岗位命中且施工≠是）人员。

一致性提示（#54）：
- 同日同车组出现 25/40 混用（排除“点名归0/清零”）时，输出“险情提示”，但不得阻断。

## 校核规则
### Hard（阻断）
- 出现“施工说明命中【施工-无工作餐】”，但该日期车组内不存在任何“施工=是 且 岗位命中=是”人员：
  - 判定为无效标记，要求人工核对，阻断流程。

### 提示（非阻断）
- 出现“施工说明命中【未施工-全组无餐补】”，但该日期车组内不存在任何“待命（岗位命中且施工≠是）”人员：
  - 输出提示，流程可继续。
